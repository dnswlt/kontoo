<!DOCTYPE html>
<html lang="en">

<head>
    {{template "head_common.html"}}
</head>

<body>
    {{template "nav.html"}}
    <h1>Positions</h1>
    {{template "positions_subnav.html" .}}
    {{ $baseCurrency := .BaseCurrency }}
    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>Code</th>
                <th>Category</th>
                <th>Type</th>
                <th>Currency</th>
                <th>Market value</th>
                <th><!-- Warnings --></th>
            </tr>
        </thead>
        <tbody>
            {{range .Groups}}
            {{range .Rows}}
            <tr>
                <td><a class="plain" href="/kontoo/ledger?q=id%3A{{urlquery .ID}}">{{ .Name }}</a></td>
                <td>{{ .ID }}</td>
                <td>{{ assetCategory .Type }}</td>
                <td>{{ assetType .Type }}</td>
                <td class="ralign">{{ .Currency }}</td>
                <td class="ralign tooltip">
                    {{ money .Value }}
                    <span class="tooltiptext">{{range .Notes}}<p>{{.}}</p>{{end}}</span>
                </td>
                <td class="tooltip">{{if gt (days .DataAge) 35}}<i class="warning-emoji"></i>{{end}}
                    <span class="tooltiptext">Data is {{days .DataAge}} days old.</span>
                </td>
            </tr>
            {{end}}
            <tr class="subtotal">
                <td>Subtotal</td>
                <td></td>
                <td>{{.Label}}</td>
                <td></td>
                <td class="ralign">{{ $baseCurrency }}</td>
                <td class="ralign">{{ money .ValueBaseCurrency }}</td>
            </tr>
            {{end}}
        </tbody>
    </table>
    <p class="footer">
        Report date: {{.Date}} (generated {{.Now}})
    </p>
    <script>
        registerDropdown("months-dropdown", (item) => {
            window.location.href = item.dataset.url;
        });
        registerDropdown("years-dropdown", (item) => {
            window.location.href = item.dataset.url;
        });
    </script>
</body>

</html>